# [Gold IV] 리그전 오브 레전드 - 23327

[문제 링크](https://www.acmicpc.net/problem/23327)

### 문제 요약

<p> $Q$개의 쿼리에 대해 각 후보 디비전에서 진행되는 리그전의 재미를 구해보자. </p>

### 제한

TL : 1sec, ML : 1024 MB

$2 ≤ N ≤ 100,000$

$1 ≤ Q ≤ 200,000$

$1 ≤ N_i ≤ 1,000$

### 성능 요약

메모리: 3584 KB, 시간: 84 ms

### 분류

누적 합(prefix_sum), 수학(math)

### comment

굉장히 좋은, 교육적인 누적 합 문제라고 생각한다.

우선 구간의 좌측을 $1$로 고정 시켜두고 재미를 구한다고 생각해보자.

이는 인기에 대한 누적 합( $a[]$ ), 재미에 대한 누적 합( $b[]$ )을 이용하면 쉽게 구해낼 수 있다.

그럼 이제 좌측이 $1$이 아닐 때, 즉 구간이 중간에 있을 때를 생각해보자. 이땐 어떻게 값을 구해낼 수 있을까?

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

구간을 $[p, q]$라 할 때 일단 $b[q]$에서 $b[p - 1]$의 값을 빼내는 것은 확실하다.

하지만 한가지 놓친 것이 있는데, $b[q] - b[p - 1]$을 한 이후에도

$b[p], b[p + 1], ... b[q]$엔 $n_1, n_2, ... n_p_1$의 영향이 남아 있다는 것이다.

따라서 남아 있는 영향을 완전히 빼내주어야 구간 $[p, q]$의 순수한 재미 값을 구할 수 있다.

$Σ(n_1, n_2, ... n_p-1)는 a[p-1]$에 담겨 있고 이것이 구간의 길이만큼 빼내져야 하므로 최종 식은 다음과 같이 정리할 수 있다.

$Q_i = b[q] - b[p - 1] - a[p - 1] * (a[q] - a[p - 1])$

