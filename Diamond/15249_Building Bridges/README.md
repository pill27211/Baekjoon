
# [Diamond V] Building Bridges - 15249

[문제 링크](https://www.acmicpc.net/problem/15249)

### 문제 요약

<p> $1$에서 $n$을 잇는 다리를 지어보려 한다. 문제의 비용 발생 정의를 따를 때, 최소로 연결하는 비용을 구해보자. </p>

### 제한

TL : 3sec, ML : 128 MB

$2 ≤ n ≤ 10^5$

$0 ≤ h_i ≤ 10^6$

$0 ≤ |w_i| ≤ 10^6$

### 성능 요약

메모리: 13708 KB, 시간: 60 ms

### 분류

다이나믹 프로그래밍(dp), 볼록 껍질을 이용한 최적화(covex hull optimization)

### comment

우선 바로 점화식을 짜보자. 

결국 임의의 위치 $i$까지 다리를 지으려면 $1$에서 바로 짓냐, $1$에서 중간 지점 $j$를 거치고 $j$에서 오냐 로 구분해 볼 수 있다. (단, $j$까지의 최소 비용이 계산 됐다는 가정 하에.)

또, $j$ ~ $i$에 존재하는 기둥들의 $Σw$ 만큼 비용이 발생 하는데 이를 $O(1)$만에 계산할 수 있도록 누적 합( $p[]$ )을 이용하자.

이를 일반화 하여 그대로 식에 옮겨주면 간단히 점화식을 정리할 수 있다.

$dp[i]$ : $1$ ~ $i$까지 가는 데에 드는 최소 비용이라 할 때 $1 ≤ j < i$ 에서

$dp[i] = min(dp[i], dp[j] + p[i - 1] - p[j] + (h[i] - h[j])^2)$

이를 모든 $i$에 대한 $j$를 돌아보면 $O(N^2)$.

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

위 식을 우선 정리해보자.

$$1 ≤ j < i$에 대해

$dp[j] + p[i - 1] - p[j] + (h[i] - h[j])^2$

$= dp[j] + p[i - 1] - p[j] + h[i]^2 - 2 * h[i] * h[j] + h[j]^2$

$j$의 변화에 관찰 되므로 $j$가 포함된 항들을 앞으로 빼보면

$= -2 * h[i] * h[j] + h[j]^2 + dp[j] - p[j] + h[i]^2 + p[i - 1]$

$h[i]$를 $x$로 보고 $Δj$의 변화와 관련 없는 항들을 상수로 빼면 $x$에 대한 일차 함수

$f(x) = -2 * h[j] * x + h[j]^2 + dp[j] - p[j] + (C)$

로 정리할 수 있다.

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

$-2 * h[j]$에 단조성이 없고.. 그 외에도 딱히 단조성이 있을만한 곳이 없어 보인다.

따라서 [이 문제](https://github.com/pill27211/Baekjoon/tree/main/Diamond/17526_Star%20Trek)를 풀면서 익히게 된 Li Chao 트리를 이용해 해결할 수 있었다.

위 식에서 상수항을 제외한 직선을 계속 추가면서 최솟값 쿼리를 날려주며 $dp$테이블(함숫값 + 상수항 ( $h[i]^2 + p[i - 1]$))을 채워줄 수 있다.

최종 $dp[n]$의 값을 출력해주면 끝.
