
# [Gold I] 서커스 나이트 - 26077

[문제 링크](https://www.acmicpc.net/problem/2565)

### 문제 요약

<p> gcd(i, j) >= 2를 만족하는 돌고래들끼리만 메시지 전파가 가능할 때, 메시지를 전달받을 수 있는 돌고래 수의 최댓값을 구해보자. </p>

### 제한

TL : 1sec, ML : 1024 MB

1 ≤ N ≤ 1,000,000

2 ≤ N_i ≤ 1,000,000

### 성능 요약

메모리: 17644 KB, 시간: 408 ms

### 분류

수학(math), 자료 구조(data structures), 정수론(number_theory), 분리 집합(disjoint_set), 소수 판정(primality_test), 에라토스테네스의 체(sieve)

### comment

N의 제한을 보자. 당연히 모든 쌍을 돌아보며 gcd()를 돌려보고 판단하는 것은 TLE 확정이다. (어떤 최적화가 필요할까 ?)

"돌고래는 자신이 들은 메시지를 다시 다른 돌고래들에게 전달할 수 있다."

-> 통신 가능한 돌고래 집합들끼리 union-find 자료구조를 이용해 효울적으로 관리해주자. (당연히 최종적으로 가장 큰 크기의 가진 집합의 사이즈가 답이 된다)

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

임의의 두 정수가 통신 가능하다는 것은, 바꿔 말하면 2 이상의 같은 소인수를 최소 하나 이상 공유한다는 것과 같다.

그리고 우리는 주어진 범위 내의 모든 수들을 빠르게 소인수분해하는 방법을 알고 있다.([문제](https://www.acmicpc.net/problem/16563))

에라토스테네스의 체와 같은 결대로 진행 된다. 하지만 차이점은 임의의 수에 단순이 '소수 여부'만을 표시해 두는 것이 아니라 해당 수의 '가장 작은 소인수'를 표시해 두는 것이다.

이 전처리를 수가 등장하는 범위(1 ~ 1,000,000)내 모든 수들에 대해 시행해주자.

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

N개의 자연수들을 입력 받으면서, 그에 맞게 해당 수의 집합 사이즈를 늘려주자. (처음에 나는 ID라길래 유일한 줄 알고 모두 1로 세팅했었는데, 문제엔 그런 말이 없다.. '= 1'이 아닌 '++'로 늘려주자)

이제 우린 입력 받은 수들을 순회하며 전처리해둔 것을 이용해 임의의 수 i를 시작으로 1이 아닐때까지 소인수 분해를 진행하며 i의 소인수들에 대해 merge연산을 시행할 것이다.

위에서 말했듯이 i와 i의 소인수들끼리 merge한다면, 사실상 i의 소인수를 소인수로 갖는 다른 모든 수들이 자동으로 merge되는 것과 같은 효과를 내기 때문이다.

이때 당연히 merge하면서 단순히 같은 집합에만 속하게 하는 것이 아니라 합쳐지는 방향으로(일관성 있게) 집합의 크기를 더해줘야 한다.

이후 가장 큰 크기를 가진 집합의 사이즈를 출력해주면 끝.

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

다양한 개념이 섞인 교육적이고 재밌는 문제인 것 같다. 이런 문제들을 만드시는 알청갓(pjshwa) 그는 대체..
