# [Platinum II] 배열의 힘 - 8462

[문제 링크](https://www.acmicpc.net/problem/8462)

### 문제 요약

<p> 길이가 $N$인 수열과 $t$개의 쿼리가 주어진다. 문제에 정의를 따를 때, 각 쿼리에서의 배열의 힘을 구해보자. </p>

### 제한

TL : 3sec, ML : 128 MB

$1 ≤ N, t ≤ 100,000$

$1 ≤ N_i ≤ 1,000,000$

1 ≤ l ≤ r ≤ N

### 성능 요약

메모리: 8288 KB, 시간: 248 ms

### 분류

오프라인 쿼리(offline queries), mo's(mo's algorithm)

### comment

우선 이 문제를 왜 자료구조 탭에 쓰고 있는지 나도 잘 모르겠다.

마땅한 분류가 없는데.. 새로 만들어야 하나 ?

아무튼 문제를 보자.

---------------------------------------------------------------------------------------------------------------------------------------------------

$K_s$가 임의의 구간 안에 있는 자연수 $s$의 개수일 때, 부분 배열의 힘은 다음과 같이 정의된다.

$P : K_s * K_s * s$

업데이트가 없음에 따라, 다음과 같이 mo's 알고리즘을 적용해볼 수 있다.

* 양 끝에서 값 $x$가 업데이트 된다고 하자. (추가던 제거던)
* 기존에 갖고 있던 구간에서 $x$로 인해 계산된 배열의 힘 역시 있을 것이다.
* 변화의 여부를 확실히 잡아내기 위해 우선 이 값을 아예 빼주자.
* 이후 업데이트를 하고 $x$에 의해 계산되는 배열의 힘을 새로 더해준다.

 그럼 결국 루트 단위 버킷에 따라 $O(sqrt(N))$에 근접하게 문제를 해결할 수 있다.
