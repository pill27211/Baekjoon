
# [Platinum III] 사탕 배달 - 20295

[문제 링크](https://www.acmicpc.net/problem/20295)

### 문제 요약

<p> n개의 정점으로 이루어진 트리 정보와 각 정점에서 구할 수 있는 사탕의 종류가 주어진다. 최단경로로만 이동할 때 주어진 사탕을 구할 수 있는지 판별해보자. </p>

### 제한

TL : 3sec, ML : 1024 MB

1 ≤ n, q ≤ 100,000

1 ≤ c ≤ 5

### 성능 요약

메모리: 28500 KB, 시간: 164 ms

### 분류

자료구조(data_structures), 트리(trees), 최소 공통 조상(lowest common ancestor), 희소 배열(sparse table)

### comment

전형적인 LCA + sparse table 문제다.

사탕의 종류가 1 ~ 5의 정수니 비트 단위로 관리해주면 편하게 상태 전이를 시킬 수 있을 듯 하다. (1 << C[i])

LCA 전처리를 하면서 2^n 단위의 경로 상 존재하는 사탕의 종류(mdp[N][k])도 함께 전처리 해두자.

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

"윤제는 시작 위치를 자유롭게 선택할 수 있다."

즉, 첫번째 쿼리{a, b}는 경로에 상관없이 b가 존재하는 정점이 있기만 하면 된다.

이를 먼저 처리해준 뒤 현재 정점(o)을 계속 업데이트 해 주며 LCA(o, a)상에서 구할 수 있는 사탕의 종류를 찾아주자.

이는 두 정점 (o, a)의 LCA를 찾아가는 과정에서 매 순간마다 해당 경로 상에서 구할 수 있는 사탕의 종류(mdp[i][j])를 or(|)연산으로 추가해 주면 된다.

그렇게 경로상 사탕의 종류를 담은 변수의 (1 << b)번째 비트가 1이라면 해당 사탕을 구할 수 있다는 뜻이 된다. 0이라면 x.

2 ~ q번째 쿼리에 대해 현재 정점을 업데이트 해주며 시뮬레이션을 돌려주면 끝.
