
# [Diamond V] 땅따먹기 - 6171

[문제 링크](https://www.acmicpc.net/problem/6171)

### 문제 요약

<p> $N$개의 땅의 $W_i, H_i$가 주어진다. 주어진 구매 규칙을 따를 때, 모든 땅을 사는 최소 비용을 구해보자. </p>

### 제한

TL : 1sec, ML : 128 MB

$1 ≤ N ≤ 50,000$

$1 ≤ W_i, H_i ≤ 1,000,000$

### 성능 요약

메모리: 4872 KB, 시간: 12 ms

### 분류

다이나믹 프로그래밍(dp), 볼록 껍질을 이용한 최적화(Convex Hull Trick)

### comment

[여기](https://github.com/pill27211/Baekjoon/tree/main/Platinum/DP/13263_%EB%82%98%EB%AC%B4%20%EC%9E%90%EB%A5%B4%EA%B8%B0)에서 CHT를 처음 경험하고 바로 다음 풀어본 문제이다.

문제의 규칙을 따르면 임의의 부분 집합 땅(k개)을 살 때

$max(W_1, W_2, ... W_k) * max(H_1, H_2, ... H_k)$

의 비용이 발생 한다고 한다.

여기서 한가지 짚고 넘어갈 게 있는 게, 부분 집합에서 $W_1 >= W_2$면서 $H_1 ≥ H_2$ 이면 2번 땅은 애초에 고려될 필요가 없다는 것이다. (결국 없는 땅이나 마찬가지 이므로)

이를 통해 다음의 전처리를 생각해 볼 수 있다.

* 일단 $W$던 $H$던 하나를 기준으로 잡고 내림차순 정렬을 한다. ( $W$를 기준으로 했다고 가정)
* $W$는 인덱스가 증가함에 따라 단조 감소 함이 보장되지만, $H$는 알 수 없다.
* 그러나 문제의 구매 조건에 의해 $i < j$면서 $H_i ≥ H_j$을 만족하는 땅 $j$는 고려할 필요가 없다.
* 따라서 $i < j$면서 $H_i < H_j$인 땅만 보면 된다.

이는 정렬 $O(N * log N)$ 후 $O(N)$만에 수행할 수 있다.

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

그렇게 추려낸 땅들로 이루어진 $V$에 맞게 $N$을 resize 해주자.

먼저 나이브한 방식을 생각해보자.

$dp[i] : i$번까지의 땅을 적절히 묶어 살 수 있는 최소 비용.

$0 ≤ j ≤ i$ 에서

$dp[i] = min(dp[i], dp[j - 1] + V[j].W * V[i].H)$

의 식으로 간단히 정리할 수 있다.

이를 그대로 수행하면 당연히 $O(N^2)$.

하지만 $V$에서, $W$는 단조 감소 한다. 또, $H_i < H_j$인 땅만 추가 했으니 $H$는 단조 증가 한다.

점화식도 그렇고 cht를 적용하기 딱인 상황인 것이다.

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

$H(i)$를 $x$로 두고 $0 ≤ j ≤ i$인 $j$에 대한 일차 함수로 표현하면

$f(x) = W(j) * x + C$ 가 되겠다.

스택에 직선들을 추가함에 있어서 $j == i$ 인 경우를 제대로 고려 하는지 꼭 확인하자.

그렇게 단조 감소하는 함숫값에 대해 이분 탐색을 적용하여 $O(N * log N)$으로 문제를 해결할 수 있다.

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
