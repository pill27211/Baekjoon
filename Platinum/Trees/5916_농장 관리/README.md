# [Platinum I] 농장 관리 - 5916

[문제 링크](https://www.acmicpc.net/problem/5916)

### 문제 요약

<p> 트리가 주어진다. 구간 단위 업데이트 쿼리와 구간 단위 합쿼리에 대해 쿼리들을 순서대로 수행하며 적절한 답을 출력해보자. </p>

### 제한

TL : 1sec, ML : 128 MB

$1 ≤ N, Q ≤ 100,000$

### 성능 요약

메모리: 23608 KB, 시간: 136 ms

### 분류

자료 구조(data structure), 트리(trees), 세그먼트 트리(segtree), 느리게 갱신되는 세그먼트 트리(lazyprop), heavy-light 분할(heavy-light decomposition), 최소 공통 조상(lowest common ancestor)

### comment

전형적인 hld 기본 예제다. (LCA + ett를 이용하여도 풀이 가능)

hld를 적용 했으면 두가지 쿼리를 적절히 처리해보자.

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

1. P u v: u번 농장과 v번 농장 사이의 경로에 존재하는 모든 도로에 나무를 하나씩 심는다.

-> 깊이가 더 낮은 정점을 체인 단위로 올려주며 $in[top[p]] ~ in[p]$에 대해 업데이트 쿼리를 날린다.

2. Q u v: u번 농장과 v번 농장 사이의 도로에 존재하는 나무의 개수를 출력한다.

-> 깊이가 더 낮은 정점을 체인 단위로 올려주며 $in[top[p]] ~ in[p]$에 대한 합쿼리 값을 누적시켜 준다.

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

위 두가지 쿼리를 처리하면서 간단한 한가지 주의할 점이 있는데,

경로에 대한 쿼리를 처리하는 것이므로 가장 높은 곳에 위치한 시작정점은 쿼리에 포함하지 않아야 한다.

따라서 같은 체인에 속할 때가 되면 $in[p] + 1 ~ in[q]$ 의 범위에 쿼리를 적용해야 한다.(단, $D[p] < D[q]$ )

업데이트 값은 항상 1로 일정하기 때문에 뭐 굳이 레이지의 형태로 할 필요가 없긴 한데 어쨋거나 자신의 취향에 맞게 하면 될 듯 하다.
